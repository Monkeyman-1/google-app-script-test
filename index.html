
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Product Info</title>
</head>
<body>

    <h1>Raw Product Information from Google Sheet</h1>
    <p>This page will dump all key-value pairs received from the Apps Script.</p>
    <p>If you see "Failed to fetch", check browser console for CORS errors. If empty, check Apps Script logs for "Sheet not found" or "no rows retrieved".</p>
    <hr>

    <button id="refreshButton">Refresh Raw Data</button>

    <div id="product-container">
        Loading data...
    </div>

    <div id="error-message" style="color: red; margin-top: 10px; border: 1px solid red; padding: 5px;"></div>

    <script>
        // Your deployed Google Apps Script Web App URL
        // This URL is specific to YOUR Google Apps Script deployment.
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbw6iKxCi4wXTysVJ-nAwIhp0V0-BZj_aYTJIOF8g9W0JxIRhymK2OEGG2f0SS4MvB4zXw/exec';

        const productContainer = document.getElementById('product-container');
        const refreshButton = document.getElementById('refreshButton');
        const errorMessage = document.getElementById('error-message');

        /**
         * Fetches product data from the Google Apps Script web app and displays all variables.
         */
        async function fetchProducts() {
            productContainer.textContent = 'Loading data...'; // Simple loading message
            errorMessage.textContent = ''; // Clear previous errors

            try {
                const response = await fetch(WEB_APP_URL);

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error("HTTP Response Not OK:", response.status, response.statusText, errorText);
                    throw new Error(`HTTP Status: ${response.status}`);
                }

                const data = await response.json();

                // Handle errors or messages directly from Apps Script
                if (data.error) {
                    throw new Error(`Apps Script Error: ${data.error}`);
                }
                if (data.message) {
                    productContainer.textContent = `Message from Script: ${data.message}`;
                    return;
                }

                if (data.length === 0) {
                    productContainer.textContent = 'No product data received (empty array).';
                    return;
                }

                // Clear previous content
                productContainer.innerHTML = '';

                // Display each item and all its variables
                data.forEach((item, index) => {
                    const div = document.createElement('div');
                    div.style.marginBottom = '15px';
                    div.style.border = '1px solid #ccc';
                    div.style.padding = '10px';

                    const itemTitle = document.createElement('h3');
                    itemTitle.textContent = `Item ${index + 1}:`;
                    div.appendChild(itemTitle);

                    const ul = document.createElement('ul');
                    ul.style.listStyleType = 'none';
                    ul.style.paddingLeft = '0';

                    // Iterate over all entries (key-value pairs) in the item object
                    Object.entries(item).forEach(([key, value]) => {
                        const li = document.createElement('li');
                        li.textContent = `Key: "${key}" | Value: "${value}" (Type: ${typeof value})`;
                        ul.appendChild(li);
                    });
                    div.appendChild(ul);
                    productContainer.appendChild(div);
                });

                console.log("Raw data fetched and displayed successfully:", data);

            } catch (error) {
                console.error("Failed to fetch data:", error);
                errorMessage.textContent = `Error: ${error.message}. Please check console for details.
                                             **Common Issues:**
                                             - **CORS:** If running from 'file:///' or 'http://localhost', try a CORS browser extension or deploy to GitHub Pages.
                                             - **Apps Script Error:** If the Apps Script URL itself doesn't return JSON in an incognito tab, check your Apps Script 'Executions' log for detailed errors.
                                             - **Incorrect Sheet Name:** Ensure the 'SHEET_NAME' in your Apps Script exactly matches your Google Sheet's tab name.
                                             - **No Data in Sheet:** Ensure your Google Sheet has data *below the header row*.`;
            }
        }

        // Add event listener to the refresh button
        refreshButton.addEventListener('click', fetchProducts);

        // Fetch data when the page loads
        document.addEventListener('DOMContentLoaded', fetchProducts);
    </script>
</body>
</html>
